/* full JS from canvas omitted here due to execution context; please paste manually if needed */